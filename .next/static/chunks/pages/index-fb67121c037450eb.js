(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2059:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var r=a(7876),s=a(4232),l=a(9367),n=a(9099),i=a(9171),d=a(7255);let o=e=>{let{onImageUpload:t,initialImage:a}=e,[l,n]=(0,s.useState)(null),o=(0,s.useRef)(null),{openModal:c}=(0,i.n)(),{addToast:m}=(0,d.d)();(0,s.useEffect)(()=>{a?n(a):n(null)},[a]);let g=async e=>{var a;let r=null==(a=e.target.files)?void 0:a[0];if(!r)return;if(!r.type.startsWith("image/"))return void m("Please select an image file.","error");let s=new FileReader;s.onloadend=()=>{n(s.result)},s.readAsDataURL(r);try{let e={timestamp:Math.round(new Date().getTime()/1e3),upload_preset:"ai-landscaping-redesigner"},a=await fetch("/api/sign-cloudinary-params",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paramsToSign:e})}),{signature:s}=await a.json(),l=new FormData;l.append("file",r),l.append("api_key","418485931189317"),l.append("timestamp",e.timestamp.toString()),l.append("signature",s),l.append("upload_preset",e.upload_preset);let n=await fetch("https://api.cloudinary.com/v1_1/".concat("dtqdq3fqq","/image/upload"),{method:"POST",body:l});if(!n.ok)throw Error("Upload to Cloudinary failed");let i=await n.json();t(i.secure_url),m("Image uploaded successfully!","success")}catch(e){console.error("Upload error:",e),m("Image upload failed. Please try again.","error"),n(null),t(null)}};return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("div",{className:"relative w-full h-56 rounded-lg text-center transition-all duration-300\n          ".concat(l?"border-0":"border-2 border-dashed border-gray-300 dark:border-gray-600 p-6 flex items-center justify-center cursor-pointer hover:border-emerald-500 dark:hover:border-emerald-400"),onClick:()=>{var e;return!l&&(null==(e=o.current)?void 0:e.click())},role:"button",tabIndex:0,onKeyDown:e=>{var t;("Enter"===e.key||" "===e.key)&&(null==(t=o.current)||t.click())},children:[(0,r.jsx)("input",{type:"file",ref:o,onChange:g,accept:"image/png, image/jpeg, image/webp",className:"hidden"}),l?(0,r.jsxs)("div",{className:"relative group w-full h-full rounded-lg overflow-hidden",children:[(0,r.jsx)("img",{src:l,alt:"Preview",className:"w-full h-full object-cover"}),(0,r.jsxs)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-lg",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),c(l)},className:"bg-sky-600 hover:bg-sky-700 text-white font-semibold px-2 md:px-4 py-2 rounded-md text-xs md:text-sm mr-2 shadow-md transition-all duration-200",children:"View"}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),n(null),t(null),o.current&&(o.current.value="")},className:"bg-red-600 hover:bg-red-700 text-white font-semibold px-2 md:px-4 py-2 rounded-md text-xs md:text-sm shadow-md transition-all duration-200",children:"Remove"})]})]}):(0,r.jsxs)("div",{className:"text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 4v.01M28 8L36 16m0 0v12m0-12h8m-4 4h.01M12 28h12m-12 4h12m-12 4h12m16-4h.01M20 20h4",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,r.jsx)("p",{className:"mt-2",children:"Click to upload or drag & drop"}),(0,r.jsx)("p",{className:"text-xs",children:"PNG, JPG, WEBP up to 10MB"})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"For best results, upload images without people, animals, or cars."})]})},c=[{id:"modern",name:"Modern"},{id:"minimalist",name:"Minimalist"},{id:"rustic",name:"Rustic"},{id:"mediterranean",name:"Mediterranean"},{id:"japanese",name:"Japanese Garden"},{id:"tropical",name:"Tropical"}],m=["Surveying the digital soil...","Sketching out the initial design...","Planting the first row of virtual shrubs...","Laying down the foundational pixels for the patio...","Choosing the perfect flowers to match your color scheme...","Unrolling the freshly rendered turf...","Adding a touch of whimsy with a garden gnome... or maybe not.","Arranging the virtual stones for a picturesque walkway...","Watering the digital plants to help them grow...","Putting the finishing touches on the lighting...","Almost there! Just admiring our handiwork..."],g=e=>{let{selectedStyle:t,onStyleSelect:a,allowStructuralChanges:s,onAllowStructuralChanges:l}=e;return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:c.map(e=>(0,r.jsx)("button",{onClick:()=>a(e.id),className:"w-full px-2 md:px-3 py-2 text-xs md:text-sm font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-emerald-500 ".concat(t===e.id?"bg-emerald-600 text-white shadow-md":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600"),"aria-pressed":t===e.id,children:e.name},e.id))}),(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:s,onChange:e=>l(e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),(0,r.jsx)("span",{className:"ml-3 text-sm text-gray-600 dark:text-gray-400",children:"Allow structural changes"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1 ml-7",children:"E.g., adding walls, gates, decks, or altering vehicles."})]})]})},x=e=>{let{value:t,onChange:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"climate-zone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Location or Climate Zone"}),(0,r.jsx)("input",{type:"text",id:"climate-zone",value:t,onChange:e=>a(e.target.value),placeholder:"e.g., Southern California, USDA Zone 9b",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-emerald-500 focus:border-emerald-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Helps the AI choose appropriate plants."})]})};var h=a(1610),u=a(6867),p=a(9707);let y=e=>{let{catalog:t}=e,{addToast:a}=(0,d.d)(),l=(null==t?void 0:t.plants)&&t.plants.length>0,n=(null==t?void 0:t.features)&&t.features.length>0,i=(0,s.useCallback)(()=>{if(!t)return;let e="Design Elements:\n\n";l&&(e+="Plants & Flora:\n",t.plants.forEach(t=>{e+="- ".concat(t.name," (").concat(t.species,")\n")}),e+="\n"),n&&(e+="Furniture & Features:\n",t.features.forEach(t=>{e+="- ".concat(t.name,": ").concat(t.description,"\n")})),navigator.clipboard.writeText(e.trim()).then(()=>{a("Design elements copied to clipboard!","success")}).catch(e=>{a("Failed to copy list.","error")})},[t,l,n,a]);return l||n?(0,r.jsxs)("div",{className:"mt-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4 sm:p-6 border border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h4",{className:"text-lg font-bold text-gray-700 dark:text-gray-300",children:"Design Elements"}),(0,r.jsxs)("button",{onClick:i,className:"flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-400 hover:text-emerald-800 dark:hover:text-emerald-200 transition-colors",children:[(0,r.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Copy List"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[l&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h5",{className:"flex items-center text-md font-semibold text-gray-600 dark:text-gray-400",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 mr-2 text-emerald-500"}),"Plants & Flora"]}),(0,r.jsx)("ul",{className:"space-y-2 pl-1",children:t.plants.map((e,t)=>(0,r.jsxs)("li",{className:"p-2 rounded-md bg-white dark:bg-gray-700/50 border border-gray-200 dark:border-gray-600/50",children:[(0,r.jsx)("p",{className:"font-medium text-sm text-gray-800 dark:text-gray-200",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:e.species})]},t))})]}),n&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h5",{className:"flex items-center text-md font-semibold text-gray-600 dark:text-gray-400",children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-2 text-sky-500"}),"Furniture & Features"]}),(0,r.jsx)("ul",{className:"space-y-2 pl-1",children:t.features.map((e,t)=>(0,r.jsxs)("li",{className:"p-2 rounded-md bg-white dark:bg-gray-700/50 border border-gray-200 dark:border-gray-600/50",children:[(0,r.jsx)("p",{className:"font-medium text-sm text-gray-800 dark:text-gray-200",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.description})]},t))})]})]})]}):null};var f=a(5691),w=a(6075),b=a(5578),j=a(6161),k=a(2120),v=a(6848);let N=()=>{let[e,t]=(0,s.useState)(0);return(0,s.useEffect)(()=>{let e=setInterval(()=>{t(e=>(e+1)%m.length)},2500);return()=>clearInterval(e)},[]),(0,r.jsx)("div",{className:"flex flex-col items-center justify-center text-center",children:(0,r.jsx)("div",{className:"relative h-10 w-full overflow-hidden",children:(0,r.jsx)(k.N,{children:(0,r.jsx)(v.P.p,{className:"absolute w-full text-lg text-gray-600 dark:text-gray-400",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.5},children:m[e]},e)})})})},C=()=>(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 animate-pulse w-full flex flex-col items-center justify-center min-h-[400px]",children:[(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsx)(N,{})}),(0,r.jsx)("div",{className:"w-full aspect-[4/3] rounded-lg bg-gray-300 dark:bg-gray-700 mt-8"})]}),S=e=>{let{title:t,imageUrl:a,catalog:s}=e,{openModal:l}=(0,i.n)(),{addToast:n}=(0,d.d)(),o=async()=>{try{let e=await fetch(a),t=await e.blob(),r=window.URL.createObjectURL(t),s=document.createElement("a");s.href=r;let l=t.type.split("/")[1]||"png";s.download="redesigned-landscape.".concat(l),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r),n("Image download started!","success")}catch(e){console.error("Error downloading image:",e),n("Failed to download image.","error")}},c=async()=>{try{let e=await fetch(a),t=await e.blob(),r=t.type.split("/")[1]||"png",s=new File([t],"redesigned-landscape.".concat(r),{type:t.type});navigator.canShare&&navigator.canShare({files:[s]})?await navigator.share({title:"AI Landscape Redesign",text:"Check out this landscape design I created with the AI Redesigner!",files:[s]}):n("Web Share API is not supported in your browser.","info")}catch(e){console.error("Error sharing:",e),"AbortError"!==e.name&&n("An error occurred while trying to share the image.","error")}};return"function"==typeof navigator.share&&navigator.canShare,(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 sm:p-6 flex flex-col",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-700 dark:text-gray-300 mb-4",children:t}),(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsxs)("div",{className:"absolute top-0 right-0 z-10 flex items-center gap-2 p-2",children:[(0,r.jsxs)("button",{onClick:()=>l(a),className:"flex items-center justify-center rounded-md bg-gray-200 px-3 py-2 text-xs font-medium text-gray-800 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 md:px-4 md:py-2 md:text-sm",children:[(0,r.jsx)(f.A,{className:"h-4 w-4 md:h-5 md:w-5 mr-1 md:mr-2"}),"Enlarge"]}),(0,r.jsxs)("button",{onClick:o,className:"flex items-center justify-center rounded-md bg-sky-500 px-3 py-2 text-xs font-medium text-white hover:bg-sky-600 dark:bg-sky-600 dark:hover:bg-sky-700 md:px-4 md:py-2 md:text-sm",children:[(0,r.jsx)(w.A,{className:"h-4 w-4 md:h-5 md:w-5 mr-1 md:mr-2"}),"Download"]}),(0,r.jsxs)("button",{onClick:c,className:"flex items-center justify-center rounded-md bg-gray-200 px-3 py-2 text-xs font-medium text-gray-800 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 md:px-4 md:py-2 md:text-sm",children:[(0,r.jsx)(b.A,{className:"h-4 w-4 md:h-5 md:w-5 mr-1 md:mr-2"}),"Share"]}),"                "]}),(0,r.jsx)("div",{className:"relative group w-full aspect-[4/3] rounded-lg overflow-hidden bg-gray-200 dark:bg-gray-700",children:(0,r.jsx)(j.x,{src:a,alt:t})})]}),(0,r.jsx)(y,{catalog:s})]})},_=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 flex items-center justify-center min-h-[400px] w-full",children:(0,r.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400",children:t})})},E=e=>{let{originalImageFile:t,redesignedImage:a,designCatalog:s,isLoading:l}=e;return l?(0,r.jsx)(C,{}):a?(0,r.jsx)(S,{title:"Redesigned",imageUrl:a,catalog:s}):t?(0,r.jsxs)(_,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-16 w-16 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707"})}),(0,r.jsx)("h3",{className:"mt-4 text-xl font-medium text-gray-800 dark:text-gray-200",children:"Ready to Redesign"}),(0,r.jsx)("p",{className:"mt-1 text-sm",children:'Click "Generate Redesign" to see the magic happen.'})]}):(0,r.jsxs)(_,{children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-16 w-16 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,r.jsx)("h3",{className:"mt-4 text-xl font-medium text-gray-800 dark:text-gray-200",children:"Your design will appear here"}),(0,r.jsx)("p",{className:"mt-1 text-sm",children:"Upload an image and select a style to get started."})]})};var A=a(4260);let R=()=>({originalImage:null,selectedStyle:c[0].id,allowStructuralChanges:!1,climateZone:""}),L=()=>{let{itemToLoad:e,onItemLoaded:t}=(0,i.n)(),{addNewRedesignToHistory:a}=(0,A.W)(),{addToast:l}=(0,d.d)(),[n,c]=(0,s.useState)(R),{originalImage:m,selectedStyle:h,allowStructuralChanges:u,climateZone:p}=n,[y,f]=(0,s.useState)(null),[w,b]=(0,s.useState)(null),[j,k]=(0,s.useState)(!1),[v,N]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&(c({originalImage:e.original_image_url,selectedStyle:e.style,allowStructuralChanges:!1,climateZone:e.climate_zone}),f(e.redesigned_image_url),b(e.design_catalog),N(null),t())},[e,t]);let C=e=>{c(t=>({...t,...e}))},S=(0,s.useCallback)(async()=>{if(!m)return void N("Please upload an image first.");k(!0),N(null),f(null),b(null);try{let e=await fetch("/api/redesign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({original_image_url:m,style:h,allowStructuralChanges:u,climateZone:p})});if(!e.ok){let t=await e.json();throw Error(t.error||"An unknown error occurred during redesign.")}let t=await e.json();a(t),f(t.redesigned_image_url),b(t.design_catalog),l("Redesign complete!","success")}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred.";console.error("Redesign failed:",e),N("Failed to generate redesign. ".concat(e,".")),l("Redesign failed: ".concat(e),"error")}finally{k(!1)}},[m,h,u,p,a,l]);return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-4 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 h-fit",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-700 dark:text-gray-300 mb-4",children:"1. Upload Your Space"}),(0,r.jsx)(o,{onImageUpload:e=>{C({originalImage:e}),f(null),b(null),N(null)},initialImage:m}),(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-700 dark:text-gray-300 mt-8 mb-4",children:"2. Select a Style"}),(0,r.jsx)(g,{selectedStyle:h,onStyleSelect:e=>C({selectedStyle:e}),allowStructuralChanges:u,onAllowStructuralChanges:e=>C({allowStructuralChanges:e})}),(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-700 dark:text-gray-300 mt-8 mb-4",children:["3. Specify Climate ",(0,r.jsx)("span",{className:"text-sm font-normal text-gray-500",children:"(Optional)"})]}),(0,r.jsx)(x,{value:p,onChange:e=>C({climateZone:e})}),(0,r.jsx)("button",{onClick:S,disabled:!m||j,className:"w-full mt-8 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center shadow-md hover:shadow-lg disabled:shadow-none",children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Redesigning..."]}):"Generate Redesign"}),v&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-4 text-center",children:v})]}),(0,r.jsx)("div",{className:"lg:col-span-8",children:(0,r.jsx)(E,{originalImageFile:m,redesignedImage:y,designCatalog:w,isLoading:j})})]})},P=()=>{let e=(0,l.useUser)(),t=(0,n.useRouter)();return((0,s.useEffect)(()=>{e||t.push("/auth")},[e,t]),e)?(0,r.jsx)(L,{}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("p",{children:"Loading..."})})}},6760:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(2059)}])}},e=>{e.O(0,[121,636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);